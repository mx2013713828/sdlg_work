# <div align='center'> ç‚¹äº‘ç›®æ ‡æ£€æµ‹å®éªŒè®°å½• </div>

#### <p align = "center">é©¬ç‰å³°ğŸ“œ</p>

------

- [1. Q1:onnxæ¨¡å‹ç›¸è¾ƒäºpthæ¨¡å‹æ˜¯å¦æœ‰ç²¾åº¦æŸå¤±ï¼Ÿæ§åˆ¶å™¨ç¯å¢ƒä¸å·¥ä½œç«™ç¯å¢ƒä¸åŒå¯¹è®¡ç®—æ˜¯å¦æœ‰å½±å“ï¼Ÿ](#1-onnxæ¨¡å‹ç›¸è¾ƒäºpthæ¨¡å‹æ˜¯å¦æœ‰ç²¾åº¦æŸå¤±ï¼Ÿæ§åˆ¶å™¨ç¯å¢ƒä¸å·¥ä½œç«™ç¯å¢ƒä¸åŒå¯¹è®¡ç®—æ˜¯å¦æœ‰å½±å“ï¼Ÿ)
- [2. Q2:ç›®å‰ä½¿ç”¨çš„æ£€æµ‹æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ](#q2-ç›®å‰ä½¿ç”¨çš„æ£€æµ‹æ¨¡å‹æ˜¯ä»€ä¹ˆ)
- [3. Q3:æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œæ¨¡å‹åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„æ£€æµ‹æ•ˆæœï¼Ÿ](#q3-æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æ¨¡å‹åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„æ£€æµ‹æ•ˆæœ)
- [4. åœ°ç£…å¤„çš„è½¦è¾†ã€è¡Œäººæ£€æµ‹ ](#åœ¨æ°´æ³¥è·¯é¢ä¸Šçš„å¯¹æ±½è½¦è¡Œäººç±»çš„æ£€æµ‹æµ‹è¯•)

------

## Q1ï¼š onnxæ¨¡å‹ç›¸è¾ƒäºpthæ¨¡å‹æ˜¯å¦æœ‰ç²¾åº¦æŸå¤±ï¼Ÿæ§åˆ¶å™¨ç¯å¢ƒä¸å·¥ä½œç«™ç¯å¢ƒä¸åŒå¯¹è®¡ç®—æ˜¯å¦æœ‰å½±å“ï¼Ÿ

- å­˜åœ¨ç²¾åº¦æŸå¤±ï¼Œä½†ç²¾åº¦æŸå¤±åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æ¥å—ï¼Œå› ä¸ºç²¾åº¦æŸå¤±ä¸»è¦æ˜¯ç”±äºæ¨¡å‹çš„å¤æ‚åº¦å’Œå‚æ•°é‡çš„å…³ç³»ï¼Œè€Œè¿™äº›å‚æ•°é‡å’Œå¤æ‚åº¦æ˜¯å¯ä»¥æ¥å—çš„ã€‚
- ç»“è®ºï¼špthç‰ˆæœ¬å’Œonnxç‰ˆæœ¬è¯¯å·®åœ¨0.01~0.1ï¼Œè¿™æ˜¯å› ä¸ºonnxæ¨¡å‹ä½¿ç”¨äº†FP16æ¨¡å¼ï¼Œå±äºæ­£å¸¸æƒ…å†µã€‚orinå’Œå·¥ä½œç«™è¯¯å·®åœ¨0.00001~0.001ï¼Œå¯¹äºå®é™…åœºæ™¯æ¥è¯´è¯¯å·®å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œä»æ£€æµ‹æ•ˆæœå›¾ä¸Šæ¥è¯´ï¼Œæ²¡æœ‰åŒºåˆ«ã€‚
- ç¯å¢ƒï¼š

    - å·¥ä½œç«™ç¯å¢ƒï¼š3090ã€ubuntu18.04ã€cuda11.1ã€tensorRT 8.1
    - æ§åˆ¶å™¨ç¯å¢ƒï¼šOrinã€ubuntu20.04ã€cuda11.4ã€tensorRT 8.5

```python
pth(3090) = [5.4163e+00,  5.1904e+00, -1.3626e+00,  4.4574e+00,  1.7968e+00,1.3981e+00,  6.5581e+00,0.8585 ]
onnx(3090) = [5.54096, 5.18851, -1.3606, 4.46109, 1.79849, 1.39713, 6.55349, 0.859889 ]
onnx(orin) = [5.53738, 5.18578, -1.3596, 4.4594, 1.79843, 1.39719, 6.55631, 0.858244 ]

pth[3090] = [3.2762e+01,  1.8629e+01, -3.9376e+00,  4.6710e+00,  2.0242e+00,1.5939e+00,  3.4192e+00,0.8112]
onnx[3090] = [32.926, 18.6292, -3.9366, 4.66959, 2.0246, 1.59392, 3.41967, 0.811268 ]
onnx[orin] = [32.9269, 18.628, -3.9383, 4.67112, 2.02401, 1.5937, 3.41862, 0.810479 ]
```
sdlg_pth_lgmg.pngâ†“
![sdlg_pth_lgmg](../images/lidar_test/sdlg_pth_lgmg.png)
sdlg_onnx_lgmg.pngâ†“
![sdlg_onnx_lgmg](../images/lidar_test/sdlg_onnx_lgmg.png)
orin_onnx_lgmg.pngâ†“
![orin_onnx_lgmg](../images/lidar_test/orin_onnx_lgmg.png)

## Q2: ç›®å‰ä½¿ç”¨çš„æ£€æµ‹æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ

- æ¨¡å‹ä½¿ç”¨åä¸ºONCEæ•°æ®é›†ï¼ŒPointpillarç½‘ç»œæ¨¡å‹ï¼Œè®­ç»ƒ300ä¸ªepochã€‚
- åä¸ºæ•°æ®é‡‡é›†è½¦ä¼ æ„Ÿå™¨é…ç½®ï¼Œä»å‡ºç‚¹æ•°æ¨æµ‹ä¼¼ä¹åº”è¯¥æ˜¯Velodyneçš„128çº¿æ¿€å…‰é›·è¾¾ï¼Œé‡‡ç”¨ä¸‰å›æ³¢æ¨¡å¼ï¼Œä»æµ‹è·èŒƒå›´å’Œç²¾åº¦çœ‹ä¼¼ä¹æ˜¯ç¦¾èµ›çš„Pandar 128çº¿ï¼Œå…¶åŒå›æ³¢æ˜¯691ä¸‡ç‚¹ã€‚åä¸ºçš„ONCEæ˜¯æ‰€æœ‰è‡ªåŠ¨é©¾é©¶è®­ç»ƒæ•°æ®é›†ä¸­æ¿€å…‰é›·è¾¾ç‚¹å¯†åº¦æœ€é«˜çš„ã€‚
- åä¸ºæ•°æ®é›†ç±»åˆ«ï¼š"car","bicycle","bus","tricycle","pedestrian","semitrailer","truck"
- åä¸ºæ•°æ®é›†Pointpillarè®­ç»ƒï¼Œ300epochsï¼Œç»“æœå¦‚ä¸‹ï¼š

|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|:-------:|:-------:|:-------:|:-------:|:-------:|
|Vehicle     |72.88       |83.92       |66.56       |51.64       |
|Pedestrian  |20.64       |24.26       |16.22       |12.38       |
|Cyclist     |52.43       |63.25       |47.59       |31.60       |
|mAP         |48.65       |57.14       |43.46       |31.87       |

## Q3: æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œæ¨¡å‹åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„æ£€æµ‹æ•ˆæœï¼Ÿ

- ä½¿ç”¨åä¸ºONCEæ•°æ®é›†è®­ç»ƒçš„pointpillaræ¨¡å‹ï¼Œonce_300ï¼Œåœ¨KITTIã€é‡æœºã€çŸ¿å±±ä¸Šçš„æ£€æµ‹æ•ˆæœå¦‚ä¸‹ï¼š

KITTIâ†“

![KITTI](../images/lidar_test/once_kitti_01.png)
![KITTI](../images/lidar_test/once_kitti_02.png)

é‡æœºâ†“

![é‡æœº](../images/lidar_test/orin_onnx_lgmg.png)

çŸ¿å±±â†“

![çŸ¿å±±](../images/lidar_test/once_kuang.png)

ONCEâ†“

![ONCE](../images/lidar_test/once_once_01.png)
![ONCE](../images/lidar_test/once_once_02.png)

- ç»“æœï¼šåœ¨kittiæ•°æ®é›†ä¸Šï¼Œæ¨¡å‹å¯¹äºå°æ±½è½¦çš„æ£€æµ‹æ•ˆæœè¾ƒå¥½ï¼Œå¯¹äºè¡Œäººå’Œå¡è½¦çš„æ£€æµ‹æ•ˆæœè¾ƒå·®ã€‚åœ¨é‡æœºæ•°æ®ä¸Šæ£€æµ‹æ•ˆæœè¾ƒå¥½ï¼Œå› ä¸ºå…¶ä¸»è¦åŒ…å«æ±½è½¦ç±»ã€‚åœ¨çŸ¿å±±æ•°æ®ä¸Šæ•ˆæœè¾ƒå·®ï¼Œå¯¹äºçŸ¿è½¦çš„è¯†åˆ«ä¸å‡†ï¼Œä¸”æ£€æµ‹æ¡†å¤§å°ä¸åŒ¹é…ã€‚

- ä½¿ç”¨kittiæ•°æ®é›†è®­ç»ƒçš„pointpillaræ¨¡å‹ï¼Œåœ¨KITTIã€é‡æœºã€çŸ¿å±±ä¸Šçš„æ£€æµ‹æ•ˆæœå¦‚ä¸‹ï¼š

KITTIâ†“

![KITTI](./images/lidar_test/kitti_kitti_01.png)
![KITTI](./images/lidar_test/kitti_kitti_02.png)

é‡æœºâ†“

![é‡æœº](./images/lidar_test/kitti_lgmg.png)

çŸ¿å±±â†“

![çŸ¿å±±](./images/lidar_test/kitti_kuang.png)

ONCEâ†“

![ONCE](./images/lidar_test/kitti_once_01.png)
![ONCE](./images/lidar_test/kitti_once_02.png)

- ç»“æœï¼šåœ¨kittiæ•°æ®é›†ä¸Šï¼Œå¯¹äºæ±½è½¦å’Œè¡Œäººç±»æ£€æµ‹æ•ˆæœè¾ƒå¥½ï¼Œåœ¨é‡æœºæ•°æ®ä¸Šæ£€æµ‹æ•ˆæœè¾ƒå¥½ï¼Œåœ¨çŸ¿å±±æ•°æ®ä¸Šæ•ˆæœæ›´å·®ï¼Œå¯¹äºçŸ¿è½¦è¯†åˆ«ä¸åˆ°ï¼Œåœ¨onceæ•°æ®ä¸ŠåŒæ ·æ•ˆæœè¾ƒå·®ï¼Œå¤§éƒ¨åˆ†onceä¸­çš„ç±»åˆ«å¦‚è¡Œäººã€è‡ªè¡Œè½¦ã€å¡è½¦ éƒ½è¯†åˆ«ä¸åˆ°ã€‚

- åˆ†æï¼š 

    - ä¸ºä½•"çŸ¿è½¦"çš„æ£€æµ‹æ•ˆæœå·®ï¼Ÿ
        - onceæ•°æ®é›†ä¸­çš„ç±»åˆ«ä¸º"car","bicycle","bus","tricycle","pedestrian","semitrailer","truck"ï¼Œè€Œkittiæ•°æ®é›†ä¸­çš„ç±»åˆ«ä¸º"car","pedestrian","cyclist"ï¼Œè€Œå®é™…åœ¨çŸ¿å±±ä¸­éœ€æ£€æµ‹çŸ¿è½¦å¹¶æ— è®­ç»ƒæ•°æ®ï¼Œä¸å…¶ç›¸è¿‘çš„ä¸ºonceæ•°æ®é›†çš„"Truck"ç±»ï¼Œä½†æ˜¯Pointpillaråœ¨æ£€æµ‹ä¸Šå±äºAnchor basedç®—æ³•ï¼Œå…¶è®­ç»ƒæ—¶é¢„è®¾çš„anchorå¤§å°ä¸çŸ¿è½¦å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œå› æ­¤æ— æ³•æ£€æµ‹åˆ°ã€‚

    - ä¸ºä½•"æ±½è½¦"ç±»çš„æ³›åŒ–æ€§å¥½ï¼Ÿ
        - åœ¨onceæ•°æ®é›†ä¸kittiæ•°æ®é›†ä¸Šéƒ½åŒ…å«carç±»åˆ«ï¼Œä¸”å…¶å‚æ•°éƒ½è¿‘ä¼¼ï¼Œå› æ­¤åœ¨æ£€æµ‹æ±½è½¦ç±»æ—¶æ•ˆæœè¾ƒå¥½ã€‚
    
    - ä¸ºä½•"è¡Œäºº"ç±»æ³›åŒ–æ€§å·®ï¼Ÿ
        - åœ¨çŸ¿å±±ä¸Šé‡‡é›†çš„æ•°æ®ã€ä»¥åŠKITTIæ•°æ®é›†ä¸Šè¿›è¡Œçš„æµ‹è¯•ä¸­ï¼Œåœ¨åœ°é¢ç‚¹äº‘å¹²æ‰°è¾ƒå¤šçš„æ—¶å€™æ£€æµ‹æ•ˆæœå·®ï¼Œåœ¨åœ°é¢ç‚¹äº‘è¾ƒå¹²å‡€æ—¶æ£€æµ‹æ•ˆæœå¥½ã€‚å…·ä½“çœ‹ä¸‹å›¾

        ##### è¡Œäººæ£€æµ‹å›¾ä¾‹
        ![kuang_person1](./images/lidar_test/kuang_person_001.png)
        ![kuang_person2](./images/lidar_test/kuang_person_004.png)
        ![kuang_person3](./images/lidar_test/kuang_person_007.png)


## åœ¨æ°´æ³¥è·¯é¢ä¸Šçš„å¯¹æ±½è½¦ã€è¡Œäººç±»çš„æ£€æµ‹æµ‹è¯•ã€‚

- æµ‹è¯•æ•°æ®info:
    - é‡‡é›†åœ°ç‚¹ï¼šå¹³é‚‘çŸ¿å±±åœ°ç£…å¤„,æ°´æ³¥åœ°é¢ã€‚
    - é‡‡é›†æ—¶é—´ï¼šä¸‹åˆ6ç‚¹20ï¼Œå¤©é»‘
    - é‡‡é›†å¯¹è±¡ï¼šçš®å¡è½¦ï¼š1ï¼Œå®¶ç”¨è½¿è½¦ï¼š1ï¼Œè¡Œäººï¼š3ã€‚
    - é‡‡é›†è®¾å¤‡ï¼šHesai 32çº¿æ¿€å…‰é›·è¾¾

- æµ‹è¯•ç»“æœï¼š

![kuang-1](./images/lidar_test/kuang_dibang_01.png)
![kuang-2](./images/lidar_test/kuang_dibang_02.png)
![kuang-3](./images/lidar_test/kuang_dibang_03.png)
![kuang-6](./images/lidar_test/kuang_dibang_06.png)
![kuang-7](./images/lidar_test/kuang_dibang_07.png)
![kuang-8](./images/lidar_test/kuang_dibang_08.png)
![kuang-11](./images/lidar_test/kuang_dibang_11.png)
![kuang-15](./images/lidar_test/kuang_dibang_15.png)
![kuang-17](./images/lidar_test/kuang_dibang_17.png)

- åˆ†æ

    - æ£€æµ‹ç»“æœæ€»ä½“è¾ƒå¥½ã€‚
    - æ¼æ£€åŸºæœ¬ä¸å­˜åœ¨ï¼Œå¯¹è¡Œäººã€æ±½è½¦éƒ½æœ‰è¾ƒå¥½çš„è¯†åˆ«ã€‚å°è¯[ä¹‹å‰çš„æ£€æµ‹ç»“æœ](#è¡Œäººæ£€æµ‹å›¾ä¾‹)ã€‚
    - å­˜åœ¨é—®é¢˜ï¼š
        - æ£€æµ‹åˆ°çš„å¯¹è±¡ä¸­ï¼Œprediction score æ™®éä¸é«˜ï¼Œ0.3 ~ 0.7å·¦å³ã€‚
        - è¯¯æ£€ä»ç„¶å­˜åœ¨ã€‚



