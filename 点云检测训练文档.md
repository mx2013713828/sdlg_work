
# <div align='center'> ⭐点云目标检测全过程记录⭐ </div>
  
<div align = "center"> <img src="https://pic.imgdb.cn/item/65dc5dfc9f345e8d03446103.png" height=100 width=300> </div>

#### <p align = "center">![Static Badge](https://img.shields.io/badge/mayufeng-blue?style=flat&label=Author)![Static Badge](https://img.shields.io/badge/2024/03/12-blue?style=flat&label=CreateTime)![Static Badge](https://img.shields.io/badge/97357473@qq\.com\-blue?style=flat&label=Email)</p>

---

## table of contents

- [权重文件与网络结构不匹配](#权重文件与网络结构不匹配问题2024-02-27)
- [torch版本不匹配问题](#torch版本不匹配问题2024-02-28)
- [可视化问题](#可视化问题2024-02-28)
- [Orin安装PointNet](#orin上安装pointnet)

## 安装OpenPCDet 和 CUDA_POINTPILLARS

### 1.安装配置OpenPCDet

- git clone OpenPCDet （可根据需求选择不同的分支版本,我使用版本基于commit 633db6bea843f8422382fc0ce5fd519fd264184d）
- 安装pytorch，1.10
    ```bash
    # 请自行按网速和源选择合适的安装方式，以下为官网安装。
    pip install torch==1.10.1+cu111 torchvision==0.11.2+cu111 -f https://download.pytorch.org/whl/cu111/torch_stable.html
    ```
- 安装spconv （pip） 
    ```bash
    pip install spconv-cu111 #这会安装spconv2
    pip install -r requirements.txt
    python setup.py develop
    ```

### 2.安装配置CUDA_POINTPILLARS

- git clone 即可  
- 使用附带的工具，将模型转化为onnx格式，注意使用时params文件也需要一并复制。
- 运行需满足 cuda、tensorrt的版本要求。

## 数据集准备 

- KITTI数据集在训练时，会将标签中的相机坐标系（X右，Y下，Z前）转为雷达坐标系（X前，Y左，Z上）

## 训练

## 模型导出

## 测试结果 

| test09 | Truck AP@0.70 | Truck AP_R40@0.70 | Truck AP@0.50 | Truck AP_R40@0.50 |
|------|------|------|------|------|
| bbox AP             | 90.6689       | 94.3483           | 90.6689       | 94.3483           |
| bev AP              | 90.1999       | 91.6337           | 90.5576       | 91.9298           |
| 3d AP               | 79.0359       | 83.7312           | 90.3645       | 91.7362           |
| aos AP              | 76.12         | 79.06             | 76.12         | 79.06             |

| test08 | Truck AP@0.70 | Truck AP_R40@0.70 | Truck AP@0.50 | Truck AP_R40@0.50 |
|------|------|------|------|------|
| bbox AP             | 90.5959       | 94.2950           | 90.5959       | 94.2950           |
| bev AP              | 90.1810       | 91.6354           | 90.5094       | 91.9164           |
| 3d AP               | 78.8702       | 83.4833           | 90.3318       | 91.7503           |
| aos AP              | 80.69         | 82.86             | 80.69         | 82.86             |
